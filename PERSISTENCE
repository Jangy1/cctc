-PERSISTENCE-

dir /R = Recursive search a directory 
more < = Shows contentsd of hidden objects
dir /a /s searchterm* = Searches for certain filename / directory
echo "hidden data" > dir:HiddenInfo.txt

Get-Item = display a specific registry key and its properties
Get-Content reminder.txt -stream secret.info

bcdedit = boot config and boot artifacts
bcdedit | finsdstr /i winload
sc query
sc qdescription
reg query

-Backup and restore Current BCD settings-
C:\demo>bcdedit /export C:\Lion\BCD
C:\demo>bcdedit /import C:\Lion\BCD

-Persistence through a service-
Get-CimInstance -classname win32_service | select displayname
tasklist /m = View all running processes and show loaded dll's for each process
Get-Process
Get-Service name | format-list * = View service and all properties in list


Select Name, ProcessId, ParentProcessId
cat suspicious files

bcdedit /deletevalue {value} valuename

-Verify mbr locating boot signature-
sudo xxd -1 512 -g 1 /dev/sda

-Persistence could be established through-
/boot/grub/x86_64-efi/normal.mod + /boot/grub/grub.cfg

lsmod = List loaded kernel modules

cat /etc/inittab = init reads to select default run levels
/etc/rc#.d = Contains scripts to start/stop daemons
top = show PID and all services correlating
Get-Process | Select Name, Id, Description | Sort -Property Id | more


greb -aob "GRUB" mbroken = Sorts binary and locates where the string is at
dd if=mbroken bs=1 skip=446 count=16 2>/dev/nll
cat .boot/grub/grub.cfg = GRUB configuration

-ALWAYS CHECK PROFILES-
$PROFILE = Command configs and environmental variables dedicated to certain user, filepaths and scripts included
AllUsersAllHosts
AllUsersCurrentHosts
CurrentUserCurrentHosts
CurrentUserAllHosts

Sticky bit = Prevents people from deleting files they dont own in shared directories "t"

shutdown /a = Aborts shutdown
shutdown /r /t 0 = restarts machine immediately 

    -System processes will not execute from user directories-
    -All dll's live in C:\Windows\system32-

-Run keys execute programs at logon-
HKLM\Software\Microsoft\Windows\CurrentVersion\Run
HKCU\Software\Microsoft\Windows\CurrentVersion\Run

-Services persist via registry-backed config-
HKLM\SYSTEM\CurrentControlSet\Services

-Per user persistence-
HKU\<SID>\Software\Microsoft\Windows\CurrentVersion\Run

-View active network connections and listening ports-
Get-NetTCPConnection -State Established 
                            Listen

-Correlate PID to process-
Get-NetTCPConnection | Select LocalPort, RemoteAddress, State, OwningProcess
Get-Process -Id <PID>

netstat -anob = All connection and listening ports, numerically, owning PID, executable responisible for the connection

-AutoRuns- *How persistence survives reboot*
-Process Monitor-    PPID *IMPORTANT*
-TCPView-   *Network*
-PSExec-    -s | -i| -c
-PsLoggedon- *Who is logged on*
-PsList- *running processes only*
-Procexp- *Explains what process is doing*
-Strings- *Extracts text from binary or text files*
-Handle- *Shows handles being used/opened currently* Handles are data that represents open instances(Files, Keys, etc)
-ListDLL's- *shows Dll's for specific executables*
            listdlls.exe <executable.exe>

-sigcheck- *File version and signature viewer* 
            sigcheck -m "exe path"

sc queryex type=service state=all *Show all services running or not*

HKLM\SYSTEM\CurrentControlSet\Services\Service_Name\Parameters *holds a service's .dll location*

get-service *show displayname and servicename*
sc showsid <service> *show sid of service*








































